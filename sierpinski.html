<html>
    <head>
        <meta charset="UTF-8" />
        <script src="https://cdn.jsdelivr.net/npm/p5@0.7.2/lib/p5.min.js"></script>
    </head>
    <body>
        <label> Size </label>
        <input type="range" min="0.5" max="25" step="0.01" value="3" oninput="lineSize=this.value" onchange="lineSize=this.value"/>
        <label> Iterations </label>
        <input type="range" min="4" max="10" step="2" value="8" oninput="restart(this.value)" onchange="restart(this.value)"/>
        <br>
    </body>

    <script>

        let instructions = "x";
        let n = 8;
        let lineSize = 3;


        function setup() {
            createCanvas(800, 800);
            stroke(255);
            angleMode(DEGREES);
            restart(n);
        }

        function restart(n) {
            instructions = "x";
            for (let i = 0; i < n; i++) {
                for (let j = instructions.length-1; j >=0; j-=2) {
                    let front = instructions.slice(0, j);
                    let back = (instructions[j] == "x" ? "y+x+y" : "x-y-x") + instructions.slice(j+1);
                    instructions = front + back;
                }
            }

            // This looks to be slower

            // for (let i = 0; i < n; i++) {
            //     instructions = instructions.split("");
            //     for (let j = instructions.length-1; j >= 0; j -= 2) {
            //         if (instructions[j] == "x") {
            //             instructions[j] = "y+x+y";
            //         } else if (instructions[j] == "y") {
            //             instructions[j] = "x-y-x";
            //         }
            //     }
            //     instructions = instructions.join("");
            // }
        }

        function draw() {
            background(0);
            let x = width*0.05;
            let y = height*0.95
            let angle = 0;
            for (let i = 1; i < instructions.length; i += 2) {
                let dx = lineSize*cos(angle);
                let dy = lineSize*sin(angle);
                line(x, y, x+dx, y+dy);
                x += dx;
                y += dy;
                if (instructions[i] == "+") {
                    angle += 60;
                } else {
                    angle -= 60;
                }
            }


            // This looks to be slower

            // background(0);
            // translate(width * 0.05, height * 0.95);

            // for (let i = 1; i < instructions.length; i += 2) {
            //     line(0, 0, lineSize, 0);
            //     translate(lineSize, 0);
            //     if (instructions[i] == "+") {
            //         rotate(60);
            //     } else {
            //         rotate(-60);
            //     }

            // }
        }

    </script>

</html>
